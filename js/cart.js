$(function(){if(localStorage.cartList){var i=JSON.parse(localStorage.cartList);!function(){if(i.length){for(var c="",l=0,t=$(".gf").clone(!1).empty().removeClass("gf").addClass("gc"),a=0;a<i.length;a++){var e=t.clone(!1);(l=i[a].checked?"checked":null)||$(".call").prop("checked",!1),c='<input type="checkbox" '+l+' class="callc" value='+i[a].id+'><div class="all"><div class="f1"><a href="javascript:;"><img src='+i[a].src+'></a></div><div class="f11"><a href="./detail.html?id='+i[a].href+'">'+i[a].title+"</a><p>"+i[a].color+'</p></div><div class="f12">￥'+i[a].price+'</div><div class="f13"><button class="bl">-</button><input type="text" class="txt" value='+i[a].num+'><button class="br">+</button></div><div class="f12" style="color:#d33a31">￥'+i[a].price+'</div><div class="del">x</div></div>',e.html(c).insertBefore(".gl")}return s(),$(".main").css("display","block")}$(".empty").css("display","block")}()}else $(".empty").css("display","block");function t(c,l){for(var t=0;t<i.length;t++)if(c==i[t].id){i[t].num=l;break}s(),localStorage.cartList=JSON.stringify(i)}function s(){for(var c=0,l=0,t=0,a=0,e=0,s=0;s<i.length;s++)e+=parseInt(i[s].num),t=i[s].num*i[s].price,a=s?2*s+1:1,$(".f12").eq(a).html("￥"+t),i[s].checked&&(c+=t,l+=parseInt(i[s].num));l?($(".ff").removeAttr("style"),$(".ff").click(function(){console.log(i),location.href="./sign.html"})):($(".ff").css("background","#ccc"),$(".ff").unbind("click")),119<c?($(".ffr>span:first").html("已享受免运费"),$(".gf>p:last>a>span:last").html("")):($(".ffr>span:first").html("差"+(119-c)+"元免运费"),$(".gf>p:last>a>span:last").html("（还差￥"+(119-c)+"元）去凑单 >")),e||$(".main").removeAttr("style").next().css("display","block"),$(".ffr>span:last").html("￥"+c),$(".num").html(l),$(".cnum").html(e),$(".gf>p:first>span").html("（ "+l+" ）")}$(".bl").click(function(){var c=$(this).parents(".gc").children(".callc").val(),l=$(this).next().val();1<l&&l--,$(this).next().val(l),t(c,l)}),$(".br").click(function(){var c=$(this).parents(".gc").children(".callc").val(),l=$(this).prev().val();l++,$(this).prev().val(l),t(c,l)}),$(".txt").on("input",function(){var c=$(this).parents(".gc").children(".callc").val(),l=$(this).val();3<=l.length&&(l=l.substr(0,3)),/^\d{1,3}$/g.test(l)&&!(l<1)&&l||(l=1),$(this).val(l),t(c,l)}),$(".del").click(function(){for(var c=$(this).parents(".gc").children(".callc").val(),l=0;l<i.length;l++)if(c==i[l].id){i.splice(l,1);break}s(),localStorage.cartList=JSON.stringify(i),$(this).parents(".gc").remove()}),$(".call").click(function(){var c=$(this).prop("checked");$(".call").prop("checked",c),$(".callc").prop("checked",c);for(var l=0;l<i.length;l++)i[l].checked=c;s(),localStorage.cartList=JSON.stringify(i)}),$(".callc").click(function(){var c=$(".callc").index($(this)),l=$(this).prop("checked");i[c].checked=l,$(".call").prop("checked",!0);for(var t=0;t<i.length;t++)if(!i[t].checked){$(".call").prop("checked",!1);break}s(),localStorage.cartList=JSON.stringify(i)})});